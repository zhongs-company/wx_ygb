import config from './config'

export var isType = function(type) {
    return function(obj) {
        return {}.toString.call(obj) == "[object " + type + "]"
    }
}
export var isObject = isType("Object")
export var isString = isType("String")
export var isArray = Array.isArray || isType("Array")
export var isFunction = isType("Function")
export var isUndefined = isType("Undefined")

/**
 * 格式化时间
 */
export var time = function(date) {
    var date = new Date(date);
    var h = date.getHours();
    var m = date.getMinutes()
    if (h < 10) {
        h = '0' + h;
    }
    if (m < 10) {
        m = '0' + m;
    }
    return h + ' : ' + m;
}

/**
 * 逗号分隔的字符串
 * '1,2,3'
 * 返回 [1,2,3]
 */
export var split = function(date) {
    return date.split(',').filter(function(item) {
        return item;
    }).map(function(item) {
        if (item.indexOf('/') === 0) {
            return item.substring(1, item.length);
        } else {
            return item;
        }
    });
}

/**
 *用来解析url参数
 *返回 key value 键值对对象
 */
export var parseQueryString = function(url) {
    var obj = {};
    var start = url.indexOf("?") + 1;
    var str = url.substr(start);
    var arr = str.split("&");
    for (var i = 0; i < arr.length; i++) {
        var arr2 = arr[i].split("=");
        obj[arr2[0]] = arr2[1];
    }
    return obj;
}

export var toFixed = function(number) {
    return (number / 100).toFixed(2);
}

export var getUrl = function(url) {
    return `${config.websocket_data_src}/${url}`;
}

export var getHeadSrc = function(str) {
    return str && str.indexOf('/0') && str.substr(0, str.length - 1) + '96';
}

export var rdNum = function() {
    return Math.random().toString(36).substr(3);
}

export var setPageTile = function(str) {
    if (!str) return;
    wx.setNavigationBarTitle({
        title: str
    })
}

